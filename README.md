# YouTube Shorts 자동화 프로그램

## 프로젝트 개요

이 프로젝트는 HTML/CSS 프론트엔드와 Python FastAPI 백엔드를 사용하여 유튜브 숏폼(30초) 영상을 자동으로 생성하는 프로그램입니다. Google Gemini API(이미지 생성, TTS)를 활용하여 장면별 이미지 생성, AI 나레이션(TTS) 녹음, 자막(.srt/.vtt) 생성, 그리고 FFmpeg를 이용한 최종 영상 조립까지의 과정을 자동화합니다.

## 오늘(2025년 8월 8일)의 작업 일지 및 로그

### 1. 프로젝트 초기 설정 및 MVP 구현

*   **폴더 구조 생성**: `shorts_auto` 디렉토리 내에 `app`, `frontend`, `tests` 등 기본적인 프로젝트 폴더 구조를 설정했습니다.
*   **핵심 서비스 모듈 구현**: 스크립트 분할(`prompt_builder.py`), 이미지 생성(`generator_image.py`), TTS 생성(`generator_tts.py`), 자막 생성(`subtitle.py`), 비디오 렌더링(`renderer.py`) 등 영상 생성 파이프라인의 핵심 모듈들을 초기 구현했습니다.
*   **FastAPI 백엔드**: 기본 API 엔드포인트(`main.py`)를 설정하여 영상 생성 요청을 처리하고, 작업 상태를 관리하는 기능을 구현했습니다.
*   **프론트엔드 UI**: 간단한 HTML/CSS 기반의 사용자 인터페이스(`index.html`, `styles.css`)를 구축하여 스크립트 입력 및 작업 상태 확인 기능을 제공합니다.

### 2. 코드 안정성 강화 (단위 테스트)

*   **테스트 환경 구축**: `unittest` 프레임워크를 사용하여 단위 테스트를 위한 `app/tests` 디렉토리를 생성했습니다.
*   **모듈별 테스트**: `prompt_builder.py`와 `subtitle.py` 모듈에 대한 단위 테스트 코드를 작성하여 각 기능의 정확성을 검증했습니다.
*   **경로 문제 해결**: 테스트 실행 시 발생했던 모듈 임포트 경로 문제를 해결하여 모든 단위 테스트가 성공적으로 통과하도록 조치했습니다.

### 3. 핵심 로직 고도화

*   **동적 스크립트 파서**: `prompt_builder.py`의 `split_script_to_scenes` 함수를 개선하여 정규식을 통해 `(시작-종료) 텍스트 [시각적 힌트]` 형식의 스크립트를 동적으로 파싱하도록 변경했습니다.
*   **부드러운 영상 전환**: `renderer.py`에 FFmpeg의 크로스페이드(Crossfade) 필터를 적용하여 장면 전환이 더욱 자연스럽고 부드럽게 이루어지도록 개선했습니다.
*   **상세한 작업 상태**: `main.py`에서 영상 생성 파이프라인의 각 단계별 진행률과 상세 메시지를 프론트엔드에 전달하도록 하여 사용자에게 더 명확한 피드백을 제공합니다.
*   **임시 파일 관리**: 작업 완료 후 생성된 임시 파일들을 정리하는 로직을 추가하여 시스템 자원 관리를 효율화했습니다.

### 4. Gemini API 연동 모의(Mocking) 테스트

*   **모의 테스트 구현**: `unittest.mock` 라이브러리를 사용하여 `generator_image.py`와 `generator_tts.py`에서 Gemini API를 호출하는 부분을 모의(Mock) 처리했습니다.
*   **다양한 시나리오 테스트**: API 키 부재, API 호출 성공, API 호출 실패 등 다양한 시나리오에 대한 테스트를 통해 API 연동 로직의 견고함을 검증했습니다.

### 5. 비동기 작업 큐 시스템 구축

*   **Celery 및 Redis 도입**: 장시간 소요되는 영상 생성 작업을 백그라운드에서 안정적으로 처리하기 위해 Celery와 Redis를 활용한 비동기 작업 큐 시스템을 구축했습니다.
*   **작업 변환**: 기존의 영상 생성 파이프라인을 Celery 작업(`create_video_task`)으로 변환하고, FastAPI가 이 작업을 Celery 큐에 전달하도록 `main.py`를 수정했습니다.
*   **프론트엔드 연동**: 프론트엔드(`index.html`)가 Celery 작업의 상태를 실시간으로 조회하고 표시할 수 있도록 업데이트했습니다.

### 6. 통합 테스트 프레임워크 구축

*   **통합 테스트 스크립트**: 전체 파이프라인의 종단 간(end-to-end) 동작을 검증하는 `integration_test.py` 스크립트를 작성했습니다.
*   **의존성 관리**: `requirements.txt`를 통해 필요한 모든 라이브러리가 설치되도록 관리합니다.
*   **FFmpeg 조건부 실행**: FFmpeg가 시스템에 설치되어 있지 않을 경우, 통합 테스트를 자동으로 건너뛰도록 하여 테스트 환경의 유연성을 확보했습니다.

### 7. GitHub 동기화

*   오늘까지의 모든 작업 내용을 `https://github.com/blueclef/autoshortsmaking` GitHub 저장소에 성공적으로 백업했습니다.

## 다음 단계

*   **실제 환경 테스트**: Redis 서버, Celery Worker, FastAPI 서버를 모두 실행하고 실제 스크립트를 입력하여 최종 영상이 생성되는지 확인합니다. (FFmpeg 설치 필수)
*   **추가 기능 구현**: PRD에 명시된 추가 기능(예: 스타일 프리셋, 음성 선택 등)을 구현합니다.

